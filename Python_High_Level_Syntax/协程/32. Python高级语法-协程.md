# **Python高级语法——协程——学习心得笔记**

# 1. 迭代器
- 可迭代（Iterable): 直接作用于for循环的变量
- 迭代器（Iterator): 不但可以用于for循环，还可以被next调用
- list是典型的可迭代对象，但不是迭代器
- isinstance判断是否可迭代或者迭代器
- iter转换可迭代的为迭代器
- 看案例32_1

# 2. 生成器
- generator：一边循环一边计算下一个元素的机制或者算法
    - 每次调用都能生成出for循环需要的下一个元素
    - 可以被next函数调用
    - 如果达到最后一个后，爆出Stoplteration异常
    - 看案例32_1
- 生成器案例   

# 3. 协程
- 用yield实现
- 实现协程比较好的包：
- asyncio, tornado, gevent  
- 从技术来讲：协程就是一个可以暂停执行的函数，或者可以理解成一个生成器
- 协程的实现：
    - yield返回
    - send调用
    - 看实例32_3，32_4
- 协程终止
    - 协程中未处理的异常会向上冒泡，传给next函数或者send方法的调用方（即触发协程的对象）   
    - 终止协程的一种方式：发送某个哨符值，让协程退出。内置的常量None和Ellipsis常作为哨符值
- yield from
    - 调用协程为了得到返回值，协程必须正常终止
    - 生成器正常终止发出StopIteration异常，异常对象的value属性保存返回值
    - yield from从内部捕获StopIteration异常
    - 看实例32_5
    - 委派生成器
        - 包含yield from表达式的生成器函数
        - 委派生成器在yield form处暂停，调用方法可以直接将数据发给生成器
        - 子生成器再把产出的值发送给调用方
        - 子生成器在最后，解释器会抛出StopIteration，并且把返回值附加到异常对象上   



 